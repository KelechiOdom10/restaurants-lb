---
import Button from "./Button.astro";
import { NumberInput } from "./NumberInput";

type Props = {
  product: {
    id: string;
    name: string;
    category: string;
    description: string;
    price: number;
    image: string;
  };
};

const { product } = Astro.props;
---

<article
  data-modal-toggle={`toggle-modal-${product.id}`}
  class="product-card mx-auto flex w-full max-w-xs flex-col overflow-hidden rounded-xl border border-slate-200 bg-white hover:cursor-pointer"
>
  <img class="max-h-36 object-cover" src={product.image} alt={product.name} />
  <div class="flex items-start justify-between p-4">
    <div class="flex flex-col space-y-2">
      <p class="text-sm font-normal text-gray-800">{product.name}</p>
      <p class="text-xs font-normal text-slate-500">{product.category}</p>
    </div>
    <p class="text-base font-medium leading-normal text-gray-800">
      ₦{product.price.toLocaleString()}
    </p>
  </div>
</article>

<div
  id={`toggle-modal-${product.id}`}
  tabindex="-1"
  aria-hidden="true"
  class="fixed inset-x-0 bottom-0 z-50 hidden w-full md:inset-0 md:h-[calc(100%-1rem)] md:p-4"
>
  <!-- Modal content -->
  <div class="relative w-full max-w-2xl rounded-t-xl bg-white md:rounded-xl">
    <!-- Modal header -->
    <header
      class="flex h-20 items-center justify-between rounded-t border-b p-4"
    >
      <button
        type="button"
        class="ml-auto inline-flex h-12 w-12 items-center justify-center gap-2 rounded-full bg-gray-100 text-black"
        data-modal-hide={`toggle-modal-${product.id}`}
      >
        <svg
          width="16"
          height="17"
          viewBox="0 0 16 17"
          class="h-5 w-5"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g id="x-close">
            <path
              id="Vector"
              d="M3.33333 13.6366L12.6667 4.30322M3.33333 4.30322L12.6667 13.6366L3.33333 4.30322Z"
              stroke="#433955"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"></path>
          </g>
        </svg>
        <span class="sr-only">Close modal</span>
      </button>
    </header>
    <!-- Modal body -->
    <div class="flex flex-col space-y-4">
      <img
        class="max-h-48 w-full object-cover xs:max-h-60 xs:min-h-[200px]"
        src={product.image}
        alt={product.name}
      />
      <div class="flex items-start justify-between p-4">
        <div
          class="flex flex-col space-y-2 text-base leading-normal text-gray-800"
        >
          <p class="font-normal">
            {product.name}
          </p>
          <p class="text-sm text-slate-500">{product.category}</p>
        </div>
        <p class="text-lg font-medium">
          ₦{product.price.toLocaleString()}
        </p>
      </div>
    </div>

    <!-- Modal footer -->
    <footer class="grid grid-cols-2 gap-4 px-4 pb-8 pt-6">
      <NumberInput client:load />
      <Button
        data-modal-hide={`toggle-modal-${product.id}`}
        fullWidth
        className="add-to-cart"
        data-product-id={product.id}
        data-product-name={product.name}
        data-product-image={product.image}
        data-product-price={product.price}
      >
        Add to cart
      </Button>
    </footer>
  </div>
</div>
